<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: node_modules/crypto-js/rabbit.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: node_modules/crypto-js/rabbit.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>;(function (root, factory, undef) {
	if (typeof exports === "object") {
		// CommonJS
		module.exports = exports = factory(require("./core"), require("./enc-base64"), require("./md5"), require("./evpkdf"), require("./cipher-core"));
	}
	else if (typeof define === "function" &amp;&amp; define.amd) {
		// AMD
		define(["./core", "./enc-base64", "./md5", "./evpkdf", "./cipher-core"], factory);
	}
	else {
		// Global (browser)
		factory(root.CryptoJS);
	}
}(this, function (CryptoJS) {

	(function () {
	    // Shortcuts
	    var C = CryptoJS;
	    var C_lib = C.lib;
	    var StreamCipher = C_lib.StreamCipher;
	    var C_algo = C.algo;

	    // Reusable objects
	    var S  = [];
	    var C_ = [];
	    var G  = [];

	    /**
	     * Rabbit stream cipher algorithm
	     */
	    var Rabbit = C_algo.Rabbit = StreamCipher.extend({
	        _doReset: function () {
	            // Shortcuts
	            var K = this._key.words;
	            var iv = this.cfg.iv;

	            // Swap endian
	            for (var i = 0; i &lt; 4; i++) {
	                K[i] = (((K[i] &lt;&lt; 8)  | (K[i] >>> 24)) &amp; 0x00ff00ff) |
	                       (((K[i] &lt;&lt; 24) | (K[i] >>> 8))  &amp; 0xff00ff00);
	            }

	            // Generate initial state values
	            var X = this._X = [
	                K[0], (K[3] &lt;&lt; 16) | (K[2] >>> 16),
	                K[1], (K[0] &lt;&lt; 16) | (K[3] >>> 16),
	                K[2], (K[1] &lt;&lt; 16) | (K[0] >>> 16),
	                K[3], (K[2] &lt;&lt; 16) | (K[1] >>> 16)
	            ];

	            // Generate initial counter values
	            var C = this._C = [
	                (K[2] &lt;&lt; 16) | (K[2] >>> 16), (K[0] &amp; 0xffff0000) | (K[1] &amp; 0x0000ffff),
	                (K[3] &lt;&lt; 16) | (K[3] >>> 16), (K[1] &amp; 0xffff0000) | (K[2] &amp; 0x0000ffff),
	                (K[0] &lt;&lt; 16) | (K[0] >>> 16), (K[2] &amp; 0xffff0000) | (K[3] &amp; 0x0000ffff),
	                (K[1] &lt;&lt; 16) | (K[1] >>> 16), (K[3] &amp; 0xffff0000) | (K[0] &amp; 0x0000ffff)
	            ];

	            // Carry bit
	            this._b = 0;

	            // Iterate the system four times
	            for (var i = 0; i &lt; 4; i++) {
	                nextState.call(this);
	            }

	            // Modify the counters
	            for (var i = 0; i &lt; 8; i++) {
	                C[i] ^= X[(i + 4) &amp; 7];
	            }

	            // IV setup
	            if (iv) {
	                // Shortcuts
	                var IV = iv.words;
	                var IV_0 = IV[0];
	                var IV_1 = IV[1];

	                // Generate four subvectors
	                var i0 = (((IV_0 &lt;&lt; 8) | (IV_0 >>> 24)) &amp; 0x00ff00ff) | (((IV_0 &lt;&lt; 24) | (IV_0 >>> 8)) &amp; 0xff00ff00);
	                var i2 = (((IV_1 &lt;&lt; 8) | (IV_1 >>> 24)) &amp; 0x00ff00ff) | (((IV_1 &lt;&lt; 24) | (IV_1 >>> 8)) &amp; 0xff00ff00);
	                var i1 = (i0 >>> 16) | (i2 &amp; 0xffff0000);
	                var i3 = (i2 &lt;&lt; 16)  | (i0 &amp; 0x0000ffff);

	                // Modify counter values
	                C[0] ^= i0;
	                C[1] ^= i1;
	                C[2] ^= i2;
	                C[3] ^= i3;
	                C[4] ^= i0;
	                C[5] ^= i1;
	                C[6] ^= i2;
	                C[7] ^= i3;

	                // Iterate the system four times
	                for (var i = 0; i &lt; 4; i++) {
	                    nextState.call(this);
	                }
	            }
	        },

	        _doProcessBlock: function (M, offset) {
	            // Shortcut
	            var X = this._X;

	            // Iterate the system
	            nextState.call(this);

	            // Generate four keystream words
	            S[0] = X[0] ^ (X[5] >>> 16) ^ (X[3] &lt;&lt; 16);
	            S[1] = X[2] ^ (X[7] >>> 16) ^ (X[5] &lt;&lt; 16);
	            S[2] = X[4] ^ (X[1] >>> 16) ^ (X[7] &lt;&lt; 16);
	            S[3] = X[6] ^ (X[3] >>> 16) ^ (X[1] &lt;&lt; 16);

	            for (var i = 0; i &lt; 4; i++) {
	                // Swap endian
	                S[i] = (((S[i] &lt;&lt; 8)  | (S[i] >>> 24)) &amp; 0x00ff00ff) |
	                       (((S[i] &lt;&lt; 24) | (S[i] >>> 8))  &amp; 0xff00ff00);

	                // Encrypt
	                M[offset + i] ^= S[i];
	            }
	        },

	        blockSize: 128/32,

	        ivSize: 64/32
	    });

	    function nextState() {
	        // Shortcuts
	        var X = this._X;
	        var C = this._C;

	        // Save old counter values
	        for (var i = 0; i &lt; 8; i++) {
	            C_[i] = C[i];
	        }

	        // Calculate new counter values
	        C[0] = (C[0] + 0x4d34d34d + this._b) | 0;
	        C[1] = (C[1] + 0xd34d34d3 + ((C[0] >>> 0) &lt; (C_[0] >>> 0) ? 1 : 0)) | 0;
	        C[2] = (C[2] + 0x34d34d34 + ((C[1] >>> 0) &lt; (C_[1] >>> 0) ? 1 : 0)) | 0;
	        C[3] = (C[3] + 0x4d34d34d + ((C[2] >>> 0) &lt; (C_[2] >>> 0) ? 1 : 0)) | 0;
	        C[4] = (C[4] + 0xd34d34d3 + ((C[3] >>> 0) &lt; (C_[3] >>> 0) ? 1 : 0)) | 0;
	        C[5] = (C[5] + 0x34d34d34 + ((C[4] >>> 0) &lt; (C_[4] >>> 0) ? 1 : 0)) | 0;
	        C[6] = (C[6] + 0x4d34d34d + ((C[5] >>> 0) &lt; (C_[5] >>> 0) ? 1 : 0)) | 0;
	        C[7] = (C[7] + 0xd34d34d3 + ((C[6] >>> 0) &lt; (C_[6] >>> 0) ? 1 : 0)) | 0;
	        this._b = (C[7] >>> 0) &lt; (C_[7] >>> 0) ? 1 : 0;

	        // Calculate the g-values
	        for (var i = 0; i &lt; 8; i++) {
	            var gx = X[i] + C[i];

	            // Construct high and low argument for squaring
	            var ga = gx &amp; 0xffff;
	            var gb = gx >>> 16;

	            // Calculate high and low result of squaring
	            var gh = ((((ga * ga) >>> 17) + ga * gb) >>> 15) + gb * gb;
	            var gl = (((gx &amp; 0xffff0000) * gx) | 0) + (((gx &amp; 0x0000ffff) * gx) | 0);

	            // High XOR low
	            G[i] = gh ^ gl;
	        }

	        // Calculate new state values
	        X[0] = (G[0] + ((G[7] &lt;&lt; 16) | (G[7] >>> 16)) + ((G[6] &lt;&lt; 16) | (G[6] >>> 16))) | 0;
	        X[1] = (G[1] + ((G[0] &lt;&lt; 8)  | (G[0] >>> 24)) + G[7]) | 0;
	        X[2] = (G[2] + ((G[1] &lt;&lt; 16) | (G[1] >>> 16)) + ((G[0] &lt;&lt; 16) | (G[0] >>> 16))) | 0;
	        X[3] = (G[3] + ((G[2] &lt;&lt; 8)  | (G[2] >>> 24)) + G[1]) | 0;
	        X[4] = (G[4] + ((G[3] &lt;&lt; 16) | (G[3] >>> 16)) + ((G[2] &lt;&lt; 16) | (G[2] >>> 16))) | 0;
	        X[5] = (G[5] + ((G[4] &lt;&lt; 8)  | (G[4] >>> 24)) + G[3]) | 0;
	        X[6] = (G[6] + ((G[5] &lt;&lt; 16) | (G[5] >>> 16)) + ((G[4] &lt;&lt; 16) | (G[4] >>> 16))) | 0;
	        X[7] = (G[7] + ((G[6] &lt;&lt; 8)  | (G[6] >>> 24)) + G[5]) | 0;
	    }

	    /**
	     * Shortcut functions to the cipher's object interface.
	     *
	     * @example
	     *
	     *     var ciphertext = CryptoJS.Rabbit.encrypt(message, key, cfg);
	     *     var plaintext  = CryptoJS.Rabbit.decrypt(ciphertext, key, cfg);
	     */
	    C.Rabbit = StreamCipher._createHelper(Rabbit);
	}());


	return CryptoJS.Rabbit;

}));</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="BlvtStream.html">BlvtStream</a></li><li><a href="CoinM.html">CoinM</a></li><li><a href="EuOptions.html">EuOptions</a></li><li><a href="Futures.html">Futures</a></li><li><a href="Http.html">Http</a></li><li><a href="Spot.html">Spot</a></li><li><a href="Websocket_.html">Websocket</a></li></ul><h3>Classes</h3><ul><li><a href="CloseEvent.html">CloseEvent</a></li><li><a href="ErrorEvent.html">ErrorEvent</a></li><li><a href="Event.html">Event</a></li><li><a href="Limiter.html">Limiter</a></li><li><a href="MessageEvent.html">MessageEvent</a></li><li><a href="PerMessageDeflate.html">PerMessageDeflate</a></li><li><a href="Receiver.html">Receiver</a></li><li><a href="Sender.html">Sender</a></li><li><a href="WebSocket.html">WebSocket</a></li><li><a href="WebSocketServer.html">WebSocketServer</a></li></ul><h3>Mixins</h3><ul><li><a href="EventTarget.html">EventTarget</a></li></ul><h3>Global</h3><ul><li><a href="global.html#_append">_append</a></li><li><a href="global.html#_createHelper">_createHelper</a></li><li><a href="global.html#_createHmacHelper">_createHmacHelper</a></li><li><a href="global.html#_isValidUTF8">_isValidUTF8</a></li><li><a href="global.html#_mask">_mask</a></li><li><a href="global.html#_parse">_parse</a></li><li><a href="global.html#_process">_process</a></li><li><a href="global.html#_unmask">_unmask</a></li><li><a href="global.html#cfg">cfg</a></li><li><a href="global.html#clamp">clamp</a></li><li><a href="global.html#clone">clone</a></li><li><a href="global.html#compute">compute</a></li><li><a href="global.html#concat">concat</a></li><li><a href="global.html#create">create</a></li><li><a href="global.html#createDecryptor">createDecryptor</a></li><li><a href="global.html#createEncryptor">createEncryptor</a></li><li><a href="global.html#createWebSocketStream">createWebSocketStream</a></li><li><a href="global.html#decrypt">decrypt</a></li><li><a href="global.html#encrypt">encrypt</a></li><li><a href="global.html#extend">extend</a></li><li><a href="global.html#finalize">finalize</a></li><li><a href="global.html#format">format</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#isValidStatusCode">isValidStatusCode</a></li><li><a href="global.html#mixIn">mixIn</a></li><li><a href="global.html#parse">parse</a></li><li><a href="global.html#process">process</a></li><li><a href="global.html#processBlock">processBlock</a></li><li><a href="global.html#random">random</a></li><li><a href="global.html#reset">reset</a></li><li><a href="global.html#toArrayBuffer">toArrayBuffer</a></li><li><a href="global.html#toBuffer">toBuffer</a></li><li><a href="global.html#toString">toString</a></li><li><a href="global.html#toX32">toX32</a></li><li><a href="global.html#update">update</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Thu Dec 01 2022 10:14:16 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
